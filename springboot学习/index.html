<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="lanyo blog coding">
    <meta name="description" content="lanyo的博客">
    <meta name="author" content="lanyoooo">
    
    <title>
        
            SpringBoot学习 |
        
        Lanyo&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.jpg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"lanyoooo.github.io","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":false,"init_open":false},"style":{"primary_color":"#0099CC","avatar":"/images/touxiang.jpg","favicon":"/images/logo.jpg","article_img_align":"center","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"质胜文则野，文胜质则史。文质彬彬，然后君子。"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Lanyo&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">SpringBoot学习</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/touxiang.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">lanyoooo</span>
                        
                            <span class="author-label">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-05-16 14:42:01</span>
        <span class="mobile">2022-05-16 14:42</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E6%A1%86%E6%9E%B6/">框架</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/spring/">spring</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>9.9k 字</span>
        </span>
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <!-- toc -->

<h2 id="开发发展变迁："><a href="#开发发展变迁：" class="headerlink" title="开发发展变迁："></a>开发发展变迁：</h2><p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220209154538663.png" alt="image-20220209154538663"></p>
<h2 id="SpringBoot学习内容："><a href="#SpringBoot学习内容：" class="headerlink" title="SpringBoot学习内容："></a>SpringBoot学习内容：</h2><p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220209155043108.png" alt="image-20220209155043108"></p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220209155330609.png" alt="image-20220209155330609"></p>
<h3 id="汇总："><a href="#汇总：" class="headerlink" title="汇总："></a>汇总：</h3><p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220209155547352.png" alt="image-20220209155547352"></p>
<h2 id="什么是SpringBoot？"><a href="#什么是SpringBoot？" class="headerlink" title="什么是SpringBoot？"></a>什么是SpringBoot？</h2><p>​		Spring Boot 基于 Spring 开发，Spirng Boot 本身并不提供 Spring 框架的核心特性以及扩展功能，**<u>只是用于快速、敏捷地开发新一代基于 Spring 框架的应用程序</u><strong>。也就是说，它</strong><em>并不是用来替代 Spring</em>* 的*解决方案，而是和 Spring 框架紧密结合用于提升 Spring 开发者体验的工具。Spring Boot 以<strong>约定大于配置的核心思想</strong>，默认帮我们进行了很多设置，多数 Spring Boot 应用只需要很少的 Spring 配置。同时它集成了大量常用的第三方库配置（例如 Redis、MongoDB、Jpa、RabbitMQ、Quartz 等等），Spring Boot 应用中这些第三方库几乎可以零配置的开箱即用。</p>
<p>​		简单来说就是SpringBoot其实不是什么新的框架，它默认配置了很多框架的使用方式，就像maven整合了所有的jar包，spring boot整合了所有的框架 。</p>
<p><strong>有哪些优点？</strong></p>
<ul>
<li>为所有Spring开发者更快的入门</li>
<li><strong>开箱即用</strong>，提供各种默认配置来简化项目配置</li>
<li>内嵌式容器简化Web项目</li>
<li>没有冗余代码生成和XML配置的要求</li>
</ul>
<p><strong>什么是微服务？</strong></p>
<p>微服务是一种分布式系统架构，按业务进行划分为独立的服务单元，解决单体系统的不足，同时也满足越来越复杂的业务需求。</p>
<p>总结起来微服务就是<strong>将一个单体架构的应用按业务划分为一个个的独立运行的程序即服务</strong>，它们之间通过HTTP协议进行通信（也可以采用消息队列来通信，如RoocketMQ，Kafaka等），可以采用不同的编程语言，使用不同的存储技术，自动化部署（如Jenkins）减少人为控制，降低出错概率。服务数量越多，管理起来越复杂，因此采用集中化管理。例如Eureka，Zookeeper等都是比较常见的服务集中化管理框架。</p>
<h2 id="第一个SpringBoot程序"><a href="#第一个SpringBoot程序" class="headerlink" title="第一个SpringBoot程序"></a>第一个SpringBoot程序</h2><p>环境：</p>
<ul>
<li>jdk 1.8</li>
<li>maven 3.6.1</li>
<li>SpringBoot 最新版</li>
<li>IDEA</li>
</ul>
<p>依赖导入剔除</p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220211165922414.png" alt="image-20220211165922414"></p>
<p><strong>要点：</strong></p>
<ul>
<li>通过spring init（生成器）来创建一个springboot项目</li>
<li>创建时导入spring-web依赖</li>
<li>可以通过修改application的properties，修改端口号（server.port&#x3D;1111)</li>
<li>可以在properties的同级下新建一个banner.txt，以此修改启动项目的banner（彩蛋）</li>
</ul>
<h2 id="原理初探"><a href="#原理初探" class="headerlink" title="原理初探"></a>原理初探</h2><h4 id="自动配置（自动装配-）"><a href="#自动配置（自动装配-）" class="headerlink" title="自动配置（自动装配*）"></a>自动配置（自动装配*）</h4><p><strong>pom.xml：</strong></p>
<ul>
<li>spring-boot-dependencies ： 核心依赖在父工程中</li>
<li>我们在引入一些SpringBoot的依赖的时候，不需要写版本号，就是因为父工程中有版本仓库。</li>
<li>但是如果是没有在依赖管理中的包，在导入时就需要手动加上版本</li>
</ul>
<p><strong>启动器：</strong></p>
<ul>
<li>即spring-boot-starter</li>
<li>不同的启动器就对应不同的启动场景（Web等）</li>
<li>比如spring-boot-starter-web，会帮我们自动导入所有web环境相关的所有依赖</li>
<li>SpringBoot将所有的功能场景都变成了启动器</li>
<li>要使用什么功能，只需要找到对应的启动器即可。</li>
</ul>
<p><strong>主程序：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloSpringBootApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//SpringApplication</span></span><br><span class="line">        SpringApplication.run(HelloSpringBootApplication.class, args);</span><br><span class="line">        <span class="comment">//将SpringBoot应用启动</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@SpringBootApplication：</p>
<p>标注在某个类上说明这个类是SpringBoot的主配置类 ， SpringBoot就应该运行这个类的main方法来启动SpringBoot应用；</p>
<p>这个注解的深层还有很多的注解——<u>@SpringBootConfiguration、@EnableAutoConfiguration、@ComponentScan</u>等。</p>
<p><strong>@ComponentScan</strong>——<strong>自动扫描并加载符合条件的组件或者bean ， 将这个bean定义加载到IOC容器中</strong></p>
<p><strong>@SpringBootConfiguration</strong>——<strong>SpringBoot的配置类，标注在某个类上，表示这是一个SpringBoot的配置类；</strong></p>
<ul>
<li>其内部还有<ul>
<li>@Configuration，说明这是一个配置类 ，配置类就是对应Spring的xml 配置文件</li>
<li>@Component ，说明启动类本身也是Spring中的一个组件而已，负责启动应用！</li>
</ul>
</li>
</ul>
<p>@EnableAutoConfiguration——开启自动配置功能</p>
<ul>
<li><p>深层注解</p>
<ul>
<li><p><strong>@AutoConfigurationPackage ：自动配置包</strong></p>
</li>
<li><p><strong>@import</strong> ：Spring底层注解@import ， 给容器中导入一个组件</p>
</li>
<li><p><strong>@Import({AutoConfigurationImportSelector.class}) ：给容器导入组件 ；</strong></p>
<ul>
<li><p>AutoConfigurationImportSelector ：自动配置导入选择器</p>
<p>​	最底层其实是调用的SpringFactoriesLoader 类的静态方法——loadFactoryNames() ，最终在      	spring.factories（自动配置的编写文件）中读取出对应的配置的设置。</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>所以，自动配置真正实现是从classpath中搜寻所有的META-INF&#x2F;spring.factories配置文件 ，并将其中对应的 org.springframework.boot.autoconfigure. 包下的配置项，通过反射实例化为对应标注了 @Configuration的JavaConfig形式的IOC容器配置类 ， 然后将这些都汇总成为一个实例并加载到IOC容器中。</strong></p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220212151347013.png" alt="image-20220212151347013"></p>
<p><strong>简而言之</strong>：</p>
<p>SpringBoot所有自动配置都是在启动的时候扫描并加载spring.factories所有的<strong>自动加载配置类</strong>。但是不一定每一个自动加载配置类都会生效，要判断条件是否成立，只要导入了对应的starter，就有对应的启动器，有了启动器，自动装配才会生效，然后才能配置成功。</p>
<h3 id="SpringApplication-run方法"><a href="#SpringApplication-run方法" class="headerlink" title="SpringApplication.run方法"></a>SpringApplication.run方法</h3><p>该方法主要分两部分，一部分是SpringApplication的实例化，二是run方法的执行；</p>
<p>SpringApplication这个类主要做了以下四件事情：</p>
<ol>
<li>推断应用的类型是普通的项目还是Web项目</li>
<li>查找并加载所有可用初始化器 ， 设置到initializers属性中</li>
<li>找出所有的应用程序监听器，设置到listeners属性中（获取上下文，处理bean）</li>
<li>推断并设置main方法的定义类，找到运行的主类</li>
</ol>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>SpringBoot使用一个全局的配置文件 ， 配置文件名称是固定的</p>
<ul>
<li>application.properties		语法结构 ：key&#x3D;value</li>
<li>application.yml                     语法结构：key：空格 value</li>
</ul>
<p><strong>配置文件的作用 ：</strong>修改SpringBoot自动配置的默认值，因为SpringBoot在底层都给我们自动配置好了；</p>
<h4 id="yaml概述："><a href="#yaml概述：" class="headerlink" title="yaml概述："></a><strong>yaml概述</strong>：</h4><p>一种以数据作为中心，而不以标记语言为中心的标记语言。</p>
<p>以前的配置文件大多使用xml，而yaml相对而言更加的简洁</p>
<h4 id="基础语法："><a href="#基础语法：" class="headerlink" title="基础语法："></a><strong>基础语法</strong>：</h4><p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220212155659671.png" alt="image-20220212155659671"></p>
<p>yaml对于空格比较敏感，语法其实非常类似于JavaScript。</p>
<p>其特殊、强大之处在于<strong>可以给实体类赋值</strong>。</p>
<h4 id="强大之处："><a href="#强大之处：" class="headerlink" title="强大之处："></a><strong>强大之处</strong>：</h4><p>yaml可以直接给属性编写一个对应的配置文件。给各个属性赋值。</p>
<p>properties同理，可以编写一个自定义的properties，然后在需要被复制的对象类，添加@PropertySource注解，让其读取指定的properties，并在对象类的各个属性上，通过@value注解，获取指定配置文件的参数来复赋值。</p>
<p><strong>拓展知识</strong></p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220214211238085.png" alt="image-20220214211238085"></p>
<p>yaml还可以调用一些spring的ER表达式：</p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220214220942138.png" alt="image-20220214220942138"></p>
<p><strong>其中，random.uuid表示可以生成一个uuid，random.int表示生成一个随机整型数，${person.hello:hello}表示获取yaml中person元素的hello属性，如果没有这个属性则采用默认值hello（冒号后面的东西）。</strong></p>
<h4 id="yaml配置与properties配置的比较"><a href="#yaml配置与properties配置的比较" class="headerlink" title="yaml配置与properties配置的比较"></a><strong>yaml配置与properties配置的比较</strong></h4><p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220214221414107.png" alt="image-20220214221414107"></p>
<h4 id="松散绑定："><a href="#松散绑定：" class="headerlink" title="松散绑定："></a><strong>松散绑定</strong>：</h4><p>java程序中的驼峰命名，在yaml中可以由 ‘-‘ 来作为分割，yaml照样可以正确读取。而@Value不支持。</p>
<p>所以，<u><em>可以有以下结论</em></u>：</p>
<ul>
<li>推荐使用yaml</li>
<li>如果只需要获取配置文件中的某一个值，那么可以使用@Value</li>
<li>如果是专门写了一个JavaBean来和配置文件映射，那么直接使用@ConfigurationProperties</li>
</ul>
<h4 id="JSP303数据校验："><a href="#JSP303数据校验：" class="headerlink" title="JSP303数据校验："></a><strong>JSP303数据校验</strong>：</h4><p>使用@Validated来校验数据，如果数据异常则会统一抛出异常，方便异常中心统一处理。</p>
<p>使用数据校验可以保证数据的正确性，常用的参数（注解）类型：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/3145530-8ae74d19e6c65b4c" alt="img"></p>
<p>（有些注释允许自定义报错信息内容，方便在检错的时候找到是哪里出了问题。）</p>
<p>​	</p>
<h4 id="配置文件的优先级"><a href="#配置文件的优先级" class="headerlink" title="配置文件的优先级"></a>配置文件的优先级</h4><p>配置文件可以在四个位置生效：（按优先级顺序排列）</p>
<ol>
<li>file:.&#x2F;config&#x2F;</li>
<li>file:.&#x2F;</li>
<li>classpath:&#x2F;config&#x2F;</li>
<li>classpath:&#x2F;      （默认位置，也是优先级最低的位置）</li>
</ol>
<p>其中，<u>file表示项目文件目录，classpath表示resources文件夹</u></p>
<h4 id="多环境配置"><a href="#多环境配置" class="headerlink" title="多环境配置"></a>多环境配置</h4><p>Springboot在准备了多个环境下不同的配置文件时，可以选择激活想要的配置文件(<strong>只适用properties</strong>)</p>
<p>这种方式要求多个配置文件遵循一个命名规范——application-name.properties&#x2F;yml</p>
<p>在配置文件中，指定spring.profiles.active &#x3D; name(不同环境配置文件的名字)</p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220222153116689.png" alt="image-20220222153116689"></p>
<p>而对于<strong>yaml作配置文件</strong>的情况</p>
<p>yaml配置文件，允许在一个配制文件中写入多种配置情况，相互之间以—作为分隔</p>
<p>同时对于不同的配置情况可以对其命名，然后选择激活想要的配置</p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220222153619886.png" alt="image-20220222153619886"></p>
<p><strong><u>但是其实还是推荐分开存放配置文件，类似properties那样子，否则项目不易管理</u></strong></p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220222155246934.png" alt="image-20220222155246934"></p>
<p><img src="/springboot%E5%AD%A6%E4%B9%A0/image-20220222155310525.png" alt="image-20220222155310525"></p>
<p><strong>同时在测试中发现，默认配置文件对其他配置文件的激活之前的配置也是会生效的</strong></p>
<h2 id="Springboot-WEB开发"><a href="#Springboot-WEB开发" class="headerlink" title="Springboot WEB开发"></a>Springboot WEB开发</h2><p>通过打jar包得到webapp</p>
<p>都说SpringBoot的自动装配，到底为我们配置了什么？能不能修改？能修改哪些？能不能扩展？</p>
<ul>
<li>xxxAutoConfiguration：向容器中自动装配组件</li>
<li>xxxProperties：自动配置类，装配配置文件中自定义的内容</li>
</ul>
<p>需要解决的问题：</p>
<ul>
<li>导入静态资源</li>
<li>定制首页</li>
<li>jsp，模板引擎Thymeleaf</li>
<li>装配扩展SpringBoot（JSON等等）</li>
<li>增删改查</li>
<li>拦截器</li>
<li>国际化</li>
</ul>
<h4 id="静态资源"><a href="#静态资源" class="headerlink" title="静态资源"></a>静态资源</h4><p>静态资源可以存放在三个位置：</p>
<ul>
<li>resources&#x2F;public&#x2F;		   （自己建文件夹）</li>
<li>resources&#x2F;static&#x2F;            （默认）</li>
<li>resources&#x2F;resources&#x2F;    （自己建文件夹）</li>
</ul>
<p>其中，优先级：<strong>resources &gt; static &gt; public</strong></p>
<p>然后可以通过，localhost:8080&#x2F;**的方式访问静态资源</p>
<h4 id="定制首页"><a href="#定制首页" class="headerlink" title="定制首页"></a>定制首页</h4><p>程序会自动搜索index.html作为web的首页，可以直接在上述三个文件夹中任意一个创建一个index.html作为首页</p>
<p>一般选择static或者public</p>
<p>网页的图标也可以自定义，但是没啥用，暂时不搞这个</p>
<h4 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h4><p>使用thymeleaf只需要导入start依赖即可</p>
<p>常用的<strong>thymeleaf</strong>命名空间：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span> </span></span><br><span class="line"><span class="tag">				<span class="attr">xmlns:sec</span>=<span class="string">&quot;http://www.thymeleaf.org/extras/spring-security&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">xmlns:shiro</span>=<span class="string">&quot;http://www.pollix.at/thymeleaf/shiro&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在页面内容中，就可以通过Thymeleaf来获取后台传输的数据，有点类似jsp的取值</p>
<p>其中，Thymeleaf的<strong>语法</strong>格式有：</p>
<ul>
<li><p><strong>使用任意的 th:attr 来替换Html中原生属性的值！</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Idia351qHgmH2vbzurk1Pp6fGYIwv043icVDYuybRJDCGTSNTMEibFzzMdlKS4t07TQoicQJKQAe0slQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
</li>
<li><p><strong>表达式</strong></p>
<p><em><u>好复杂，建议要使用的时候再看官方文档</u></em></p>
</li>
</ul>
<h4 id="使用bootstrap模板"><a href="#使用bootstrap模板" class="headerlink" title="使用bootstrap模板"></a>使用bootstrap模板</h4><ul>
<li>下载模板，html页面加到templates文件夹下，其他的样式等静态资源加到static文件夹下。</li>
<li>关闭Thymeleaf的缓存，在HTML中加入Thymeleaf的命名空间，表达式那些不用管<ul>
<li>如果有表达式，那么在修改了context-path的情况下可以自动拼接。</li>
<li>默认情况下，html中的css、js的路径就已经满足读取的要求了。</li>
<li><strong>所以最好还是将静态资源交给Thymeleaf接管。</strong></li>
<li><strong>对于静态资源的读取，@{&#x2F;}即可，其中的&#x2F;就已经表示在&#x2F;static文件夹下了</strong></li>
</ul>
</li>
</ul>
<h4 id="关于样式丢失的问题"><a href="#关于样式丢失的问题" class="headerlink" title="关于样式丢失的问题"></a>关于样式丢失的问题</h4><ul>
<li>尝试自定义资源拦截器，对静态资源放行</li>
<li>尝试用thymeleaf接管静态资源</li>
<li>一般来说写好的路径是没问题的，不用再次修改（改多或者改少）</li>
</ul>
<h4 id="装配扩展springmvc"><a href="#装配扩展springmvc" class="headerlink" title="装配扩展springmvc"></a>装配扩展springmvc</h4><p><strong>自定义视图解析器：（不怎么用）</strong></p>
<p>自定义一个视图解析类，将其交给SpringBoot，然后SpringBoot就会帮我们自动装配。</p>
<p>只要是继承了ViewResolver的类，就可以作为一个视图解析器。</p>
<p>同时自定义的视图解析器的类，需要@Configuration的注解，不可以加上@EnableViewResolver的注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//实现了ViewResolver的类就可以作为视图解析器，交给SpringBoot来自动装配</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ViewResolver <span class="title function_">MyViewResolver</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyViewResolver</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义的视图解析器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyViewResolver</span> <span class="keyword">implements</span> <span class="title class_">ViewResolver</span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> View <span class="title function_">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>还可以<u>通过扩展视图跳转控制（器）来扩展视图解析器</u>的功能：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyWebMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">//向浏览器输入webmvc。会跳转到/test对应的页面</span></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/webmvc&quot;</span>).setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>总结</strong>：</p>
<p>在springboot中，可以通过自定义xxxConfiguration来扩展SpringBoot的配置。</p>
<p>@EnableWebMvc注解会让webmvc自带的配置都失效，用户可以自己定义全新的完整的Configuration</p>
<h4 id="页面国际化"><a href="#页面国际化" class="headerlink" title="页面国际化"></a>页面国际化</h4><ol>
<li><p>配置i18n文件</p>
</li>
<li><p>自定义一个localeResolver</p>
<ol>
<li><p>页面中需要<strong>传参</strong>语言类型，交给解析器（<strong>用th:href，和@{}表达式，括号传参</strong>）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/index.html(lang=&#x27;zh_CN&#x27;)&#125;&quot;</span>&gt;</span>中文<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/index.html(lang=&#x27;en_US&#x27;)&#125;&quot;</span>&gt;</span>English<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>解析器会调用返回不同的i18n配置的页面内容（text）</p>
</li>
</ol>
</li>
<li><p>将resolver<strong>装配为Bean</strong></p>
</li>
<li><p>取值符号 #{}</p>
</li>
</ol>
<h4 id="登录-拦截器"><a href="#登录-拦截器" class="headerlink" title="登录+拦截器"></a>登录+拦截器</h4><p>将前端的账号密码信息发送到后端进行校验</p>
<p>同时配置拦截器，避免用户不通过登录直接进入到需要登录的页面。</p>
<p>自定义拦截器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//登陆成功以后，应该有用户的session</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">loginUser</span> <span class="operator">=</span> request.getSession().getAttribute(<span class="string">&quot;loginUser&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(loginUser==<span class="literal">null</span>)&#123;<span class="comment">//没有登录</span></span><br><span class="line">            request.setAttribute(<span class="string">&quot;Not_login&quot;</span>,<span class="string">&quot;没有权限，请先登录&quot;</span>);</span><br><span class="line">            request.getRequestDispatcher(<span class="string">&quot;/index.html&quot;</span>).forward(request,response);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//return HandlerInterceptor.super.preHandle(request, response, handler);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在登录校验中传递session信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String username,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;pass&quot;)</span> String password,</span></span><br><span class="line"><span class="params">                    HttpSession session,</span></span><br><span class="line"><span class="params">                    Model model)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;收到了来自login页面的请求&quot;</span>);<span class="comment">//action没有问题</span></span><br><span class="line">    <span class="keyword">if</span>(username != <span class="literal">null</span> &amp;&amp; password.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">        session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,username);</span><br><span class="line">        <span class="comment">//可以成功跳转到DashBoard，想要跳转后域名上不带有账号密码，就要重定向，并且重定向的地址要和config中配置的完全一样</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/board.html&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在配置类中注册自定义的拦截器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加自定义登录拦截器</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">	registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginHandlerInterceptor</span>())</span><br><span class="line">	.addPathPatterns(<span class="string">&quot;/**&quot;</span>) .excludePathPatterns(<span class="string">&quot;/index.html&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;/user/login&quot;</span>,<span class="string">&quot;/css/**&quot;</span>,<span class="string">&quot;/js/**&quot;</span>,<span class="string">&quot;/images/**&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="展示员工页面："><a href="#展示员工页面：" class="headerlink" title="展示员工页面："></a>展示员工页面：</h4><ol>
<li><p>提取公共页面</p>
<ol>
<li>th:fragment &#x3D; “sidebar”</li>
<li>th:replace &#x3D; “~{commons&#x2F;commons::topbar}”</li>
<li>如果要使用参数，可以直接使用（）传参，接受判断即可。</li>
</ol>
</li>
<li><p>列表循环展示</p>
</li>
<li><p>添加员工</p>
<ol>
<li>按钮提交</li>
<li>跳转到添加页面</li>
<li>添加员工成功</li>
<li>返回首页</li>
</ol>
</li>
<li><p>CRUD</p>
</li>
<li><p>404</p>
<ul>
<li>把404页面拖到template文件夹下的error文件夹即可，spring会自动接管，将其改造为特殊的404页面</li>
<li>其他错误页面同理（400、500）</li>
</ul>
</li>
</ol>
<h2 id="如何写一个完整的项目"><a href="#如何写一个完整的项目" class="headerlink" title="如何写一个完整的项目"></a>如何写一个完整的项目</h2><ol>
<li>前端长什么样子、数据怎么展示</li>
<li>设计数据库（难点）</li>
<li>独立化前端，让其能够正常运行</li>
<li>对接数据接口：json、对象（all in one)</li>
<li>前后端联调</li>
</ol>
<p>要求：</p>
<ul>
<li>有一套自己熟悉的后台模板：工作必要，推荐x-admin </li>
<li>前端界面：要能够自己通过前端框架，组合出来一个网站页面，内容：<ul>
<li>index</li>
<li>about</li>
<li>blog</li>
<li>post</li>
<li>user</li>
</ul>
</li>
<li>让项目运行起来</li>
</ul>
<p>做一个完整的项目至少需要一个月时间。</p>
<h2 id="回顾环节"><a href="#回顾环节" class="headerlink" title="回顾环节"></a>回顾环节</h2><ul>
<li>springboot是什么</li>
<li>微服务</li>
<li>能写Helloworld程序吗</li>
<li>探究了源码、自动装配原理</li>
<li>配置yaml</li>
<li>多文档环境切换</li>
<li>静态资源映射</li>
<li>Thymeleaf</li>
<li>springboot如何拓展MVC      通过javaConfig</li>
<li>如何及修改springboot的默认配置   通过配置文件</li>
<li>实现CRUD</li>
<li>国际化</li>
<li>拦截器</li>
<li>定制首页、错误页</li>
</ul>
<h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><ul>
<li>JDBC</li>
<li><strong>Mybatis</strong></li>
<li><strong>Druid</strong></li>
<li><strong>Shiro</strong>    安全框架</li>
<li><strong>Spring Security</strong>    安全框架</li>
<li>异步任务、邮件发送、定时任务</li>
<li>Swagger   <u><em>前后端文档交接</em></u></li>
<li>Dubbo + Zookeeper</li>
</ul>
<h2 id="整合数据源"><a href="#整合数据源" class="headerlink" title="整合数据源"></a>整合数据源</h2><h3 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h3><p>springboot整合JDBC</p>
<ul>
<li><p>配置数据源</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">lin1140144729</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试数据源（在项目自带的test文件中）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//查看一下默认的数据源    com.zaxxer.hikari.HikariDataSource</span></span><br><span class="line">    <span class="comment">//System.out.println(dataSource.getClass());</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//获得数据库链接   com.mysql.cj.jdbc.ConnectionImpl@67774e29</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> dataSource.getConnection();</span><br><span class="line">    System.out.println(connection);</span><br><span class="line"></span><br><span class="line">    connection.close();<span class="comment">//打开连接后要记得关闭数据库连接</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用</p>
<ul>
<li><p>注入<strong>jdbcTemplate</strong></p>
</li>
<li><p>可以直接写controller，写sql语句交给jdbcTemplate去执行</p>
</li>
<li><p>springboot会自动处理事务相关的东西。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/userList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; <span class="title function_">userList</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate.queryForList(sql);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/updateUser/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line">	<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update mybatis.user set name = ?, pwd = ? where id = &quot;</span> + id;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//封装name和pwd</span></span><br><span class="line">	Object[] objects = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">2</span>];</span><br><span class="line">	objects[<span class="number">0</span>] = <span class="string">&quot;upd名字&quot;</span>;</span><br><span class="line">	objects[<span class="number">1</span>] = <span class="string">&quot;upd密码&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//会自动帮我们**提交事务**</span></span><br><span class="line">	jdbcTemplate.update(sql,objects);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;update user OK!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="Druid"><a href="#Druid" class="headerlink" title="Druid"></a>Druid</h3><p>Druid是阿里巴巴开源平台上的一个数据库连接池实现。结合CP30、DBCP、PROXOOL等DB池的优点，同时加入了<strong>日志监控</strong>。</p>
<p>Druid可以很好的监控DB池连接和SQL的执行情况，天生就是针对监控而生的DB连接池。</p>
<p>Springboot2.0以上默认使用Hikari数据源，可以说Hikari和Druid都是当前JavaWeb上最优秀的数据源。</p>
<ul>
<li><p>导入Druid的依赖</p>
<p><a class="link" target="_blank" rel="noopener" href="https://mvnrepository.com/">maven仓库<i class="fas fa-external-link-alt"></i></a></p>
</li>
<li><p>在配置文件中配置连接池类型</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试连接池类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//com.alibaba.druid.pool.DruidDataSource   : &#123;dataSource-0&#125; closing ...</span></span><br><span class="line">System.out.println(dataSource.getClass());</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置Druid的私有属性</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SpringBoot默认是不注入这些的，需要自己绑定</span></span><br><span class="line"><span class="comment">#druid数据源专有配置</span></span><br><span class="line"><span class="attr">initialSize:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">minIdle:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">maxActive:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">maxWait:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line"><span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line"><span class="attr">testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">testOnReturn:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置监控统计拦截的filters，stat：监控统计、log4j：日志记录、wall：防御sql注入</span></span><br><span class="line"><span class="comment">#如果允许报错，java.lang.ClassNotFoundException: org.apache.Log4j.Properity</span></span><br><span class="line"><span class="comment">#则导入log4j 依赖就行</span></span><br><span class="line"><span class="attr">filters:</span> <span class="string">stat,wall,log4j</span></span><br><span class="line"><span class="attr">maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br></pre></td></tr></table></figure>

<p>（其中的log4j的使用，需要导包，如果没有导包可能就无法运行）</p>
<p><strong>log4j的包只能导入老版本，双ID都是log4j的，如果是core的或其他的会不行。（logger的问题？）</strong></p>
</li>
<li><p><strong>编写一个Druid的配置类（@Configuration）</strong></p>
<ul>
<li><strong>配置Druid的数据源</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;spring.datasource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> DataSource <span class="title function_">druidDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>配置后台监控和资源过滤器</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//后台监控  相当于一个web.xml 可以配置东西</span></span><br><span class="line"><span class="comment">//因为SpringBoot内置了servlet容器，所以没有web.xml，替代方法：配置一个ServletRegistrationBean，他是一个专门用来配置的类。</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ServletRegistrationBean <span class="title function_">statViewServelt</span><span class="params">()</span>&#123;</span><br><span class="line">    ServletRegistrationBean&lt;StatViewServlet&gt; bean = <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">StatViewServlet</span>(),<span class="string">&quot;/druid/*&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后台需要有人登录，配置的登录的账号密码</span></span><br><span class="line">    HashMap&lt;String, String&gt; initParameters = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//增加配置</span></span><br><span class="line">    <span class="comment">//登录的key和value是固定的</span></span><br><span class="line">    initParameters.put(<span class="string">&quot;loginUsername&quot;</span>, <span class="string">&quot;admin&quot;</span>);	<span class="comment">//这两个参数不能改</span></span><br><span class="line">    initParameters.put(<span class="string">&quot;loginPassword&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//允许谁可以访问</span></span><br><span class="line">    initParameters.put(<span class="string">&quot;allow&quot;</span>,<span class="string">&quot;&quot;</span>);         <span class="comment">//v为空表示谁都可以</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//禁止访问      initParameters.put(&quot;lanyo&quot;,&quot;IP地址&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//将配置信息以及初始化参数交给bean</span></span><br><span class="line">    bean.setInitParameters(initParameters);</span><br><span class="line">    <span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置一个资源过滤器</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> FilterRegistrationBean <span class="title function_">webStatFilter</span><span class="params">()</span>&#123;</span><br><span class="line">    FilterRegistrationBean&lt;Filter&gt; bean = <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//设置web状态过滤器</span></span><br><span class="line">    bean.setFilter(<span class="keyword">new</span> <span class="title class_">WebStatFilter</span>());</span><br><span class="line">    <span class="comment">//通过map记录配置参数</span></span><br><span class="line">    HashMap&lt;String, String&gt; initParameters = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    initParameters.put(<span class="string">&quot;exclusions&quot;</span>,<span class="string">&quot;*.js,*.css,/druid/*&quot;</span>);</span><br><span class="line">    <span class="comment">//将配置的参数填入bean，并将bean返回</span></span><br><span class="line">    bean.setInitParameters(initParameters);</span><br><span class="line">    <span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Druid的使用：</p>
<ul>
<li>在localhost路径下，进入&#x2F;Druid，再通过自己配置的账号密码登入，就可以看到Druid监控的各种信息。</li>
</ul>
</li>
</ul>
<h4 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h4><p>log4j的导包问题</p>
<p>Druid的登录用户、密码配置问题</p>
<p>后台监控、资源过滤的配置问题——创建bean的时候最好直接注明类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ServletRegistrationBean&lt;==StatViewServlet==&gt;</span><br><span class="line">FilterRegistrationBean&lt;==Filter==&gt; </span><br></pre></td></tr></table></figure>



<h2 id="整合mybatis"><a href="#整合mybatis" class="headerlink" title="整合mybatis"></a>整合mybatis</h2><p> 导入mybatis官方提供的整合包<strong>mybatis-spring-boot-starter</strong></p>
<ol>
<li><p>导入包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mybatis-spring-boot-starter</span><br><span class="line">spring-boot-starter-jdbc</span><br><span class="line">mysql-connector-java</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<p>配置数据库环境</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">lin1140144729</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>mybatis配置</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#整合mybatis</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.example.springbootmybatis.pojo</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mybatis/mapper/*.xml</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写sql（mapper.xml）</p>
</li>
<li><p>service层调dao层</p>
</li>
<li><p>controller层调service层</p>
</li>
</ol>
<h2 id="SpringSecurity"><a href="#SpringSecurity" class="headerlink" title="SpringSecurity"></a>SpringSecurity</h2><p>开发项目，安全是一个首要因素，如果说项目基本架构都完成了再来追加安全管理，会很麻烦。</p>
<p>因此在开发时，越早把安全搞定越好。</p>
<h3 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h3><p>需要导入启动器：spring-boot-starter-security</p>
<p>如果需要和Thymeleaf整合使用的话m，还需要导入thymeleaf-extras-springsecurity5</p>
<p>同时，在使用了Thymeleaf的页面使用springsecurity的话，还需要引入命名空间：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:sec=&quot;http://www.thymeleaf.org/extras/spring-security&quot;</span><br></pre></td></tr></table></figure>



<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>配置一个SecurityConfig类，继承<strong>WebSecurityConfigurerAdapter</strong>类，并重写configure方法，以此来配置SpringSecurity的运行。</p>
<p>注意，configure方法有三个重载，主要使用的是<strong>AuthenticationManagerBuilder auth</strong>授权管理重载、</p>
<p><strong>HttpSecurity http</strong>网络安全管理重载</p>
<p>configure方法的代码使用的是<strong>链式编程</strong>。</p>
<h4 id="用户授权"><a href="#用户授权" class="headerlink" title="用户授权"></a>用户授权</h4><p>在AuthenticationManagerBuilder auth重载方法里实现。</p>
<p>可以通过内存设置用户的权限，也可以通过数据库给用户授权</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auth.inMemoryAuthentication().passwordEncoder(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>())</span><br><span class="line">                .withUser(<span class="string">&quot;lanyo&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;123&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>).and()</span><br></pre></td></tr></table></figure>

<p>通过.and()方法就可以一直往下配置用户授权。</p>
<h4 id="权限验证"><a href="#权限验证" class="headerlink" title="权限验证"></a>权限验证</h4><p>权限验证是给功能模块加上对于用户的权限的要求。</p>
<p>在configure(HttpSecurity http)中实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http.authorizeRequests()</span><br><span class="line">        .antMatchers(<span class="string">&quot;/&quot;</span>).permitAll()</span><br><span class="line">        .antMatchers(<span class="string">&quot;/level1/**&quot;</span>).hasRole(<span class="string">&quot;vip1&quot;</span>)</span><br><span class="line">        .antMatchers(<span class="string">&quot;/level2/**&quot;</span>).hasRole(<span class="string">&quot;vip2&quot;</span>)</span><br><span class="line">        .antMatchers(<span class="string">&quot;/level3/**&quot;</span>).hasRole(<span class="string">&quot;vip3&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>antMatchers就是设置模块对应的href</p>
<p>hasRole就是设置对于用户的权限的<strong>要求</strong>。</p>
<h4 id="开启注销"><a href="#开启注销" class="headerlink" title="开启注销"></a>开启注销</h4><p>注销后的跳转可能会被CSRF拦截，导致无法正常注销</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启注销功能，注销后跳到首页</span></span><br><span class="line">http.logout().logoutSuccessUrl(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="comment">//可以清除cookie和关闭session，一般不会这么干</span></span><br><span class="line"><span class="comment">// http.logout().deleteCookies(&quot;remove&quot;).invalidateHttpSession(true);</span></span><br></pre></td></tr></table></figure>



<h4 id="登录页面"><a href="#登录页面" class="headerlink" title="登录页面"></a>登录页面</h4><p>SpringSecurity提供了默认的用户登录页面，但是也允许用户自定义登录页面，只要配置好路径就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有权限就会默认跳转到默认的登录页面。可以通过loginPage设置登录页面</span></span><br><span class="line">http.formLogin().loginPage(<span class="string">&quot;/toLogin&quot;</span>);</span><br></pre></td></tr></table></figure>



<h4 id="记住我"><a href="#记住我" class="headerlink" title="记住我"></a>记住我</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启记住我功能  通过cookie实现，能够保存两个星期</span></span><br><span class="line">http.rememberMe().rememberMeParameter(<span class="string">&quot;在前端页面写定的记住我参数&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>同理，登录账号、账号密码的传参也可以在HTTP的重载方法中修改。</p>
<h4 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h4><p>SpringSecurity默认开启，会自动拦截绝大多数get请求，所以前端写的请求都要改为<strong>post</strong>，以免被拦截。</p>
<p>也可以将其关闭</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.csrf().disable();</span><br></pre></td></tr></table></figure>



<h2 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ol>
<li>导入依赖</li>
<li>配置角色</li>
<li>HelloWorld</li>
</ol>
<p>Shiro有三大核心对象：<strong>subject、securityManager、realm</strong></p>
<p>即<strong>用户、管理用户、连接数</strong></p>
<p><strong>Subject</strong>：主体，代表了当前“用户”，这个用户不一定是一个具体的人，<strong>与当前应用交互的任何东西都是Subject</strong>，如网络爬虫，机器人等；即一个抽象概念；所有Subject都绑定到SecurityManager，与Subject的所有交互都会委托给SecurityManager；可以把<strong>Subject认为是一个门面；SecurityManager才是实际的执行者</strong>；</p>
<p>常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Subject</span> <span class="variable">currentUser</span> <span class="operator">=</span> SecurityUtils.getSubject()</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> currentUser.getSession()</span><br><span class="line">currentUser.isAuthenticated()</span><br><span class="line">currentUser.getPrincipal()</span><br><span class="line">currentUser.hasRole(<span class="string">&quot;&quot;</span>)</span><br><span class="line">currentUser.isPermitted(<span class="string">&quot;&quot;</span>)</span><br><span class="line">currentUser.logout()</span><br></pre></td></tr></table></figure>



<h3 id="整合到SpringBoot"><a href="#整合到SpringBoot" class="headerlink" title="整合到SpringBoot"></a>整合到SpringBoot</h3><h4 id="导包："><a href="#导包：" class="headerlink" title="导包："></a>导包：</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>shiro不属于spring生态，所以引入依赖的时候需要注明版本号</p>
<h4 id="配置shiro"><a href="#配置shiro" class="headerlink" title="配置shiro"></a>配置shiro</h4><p><strong>配置一个shiro的配置类</strong></p>
<ol>
<li>创建realm对象</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1  创建realm对象，需要自定义类。</span></span><br><span class="line"><span class="meta">@Bean(name = &quot;userRealm&quot;)</span>   <span class="comment">//qualifier的默认指定就是根据方法名来的，所以这个name属性可以不写</span></span><br><span class="line"><span class="keyword">public</span> UserRealm <span class="title function_">userRealm</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserRealm</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建安全管理器（SecurityManager)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2  DefaultWebSecurityManager</span></span><br><span class="line"><span class="meta">@Bean(name = &quot;securityManager&quot;)</span></span><br><span class="line"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title function_">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span>&#123;</span><br><span class="line">	<span class="type">DefaultWebSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultWebSecurityManager</span>();</span><br><span class="line">	<span class="comment">//关联UserRealm</span></span><br><span class="line">	securityManager.setRealm(userRealm);</span><br><span class="line">	<span class="keyword">return</span> securityManager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>创建shiro的过滤器工厂的bean(ShiroFilterFactoryBean)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title function_">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;securityManager&quot;)</span> DefaultWebSecurityManager defaultWebSecurityManager)</span>&#123;</span><br><span class="line">    <span class="type">ShiroFilterFactoryBean</span> <span class="variable">bean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShiroFilterFactoryBean</span>();</span><br><span class="line">    <span class="comment">//设置安全管理器</span></span><br><span class="line">    bean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加shiro的过滤器，实现拦截功能</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * anon：无需认证就可以访问的</span></span><br><span class="line"><span class="comment">        * authc:必须认证了的才能访问</span></span><br><span class="line"><span class="comment">        * user:必须拥有 记住我 功能才能用</span></span><br><span class="line"><span class="comment">        * perms:拥有对某个资源的权限才能访问</span></span><br><span class="line"><span class="comment">        * role：拥有某个角色权限才能访问</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    LinkedHashMap&lt;String, String&gt; filterMap = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">    filterMap.put(<span class="string">&quot;/user/add&quot;</span>,<span class="string">&quot;authc&quot;</span>);</span><br><span class="line">    filterMap.put(<span class="string">&quot;/user/update&quot;</span>,<span class="string">&quot;authc&quot;</span>);</span><br><span class="line">    <span class="comment">//也可以使用通配符设置上面两个过滤条件</span></span><br><span class="line">    <span class="comment">//filterMap.put(&quot;/user/*&quot;,&quot;authc&quot;);</span></span><br><span class="line">    bean.setFilterChainDefinitionMap(filterMap);    <span class="comment">//将配置好的拦截要求，交给bean</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置登录的请求</span></span><br><span class="line">    bean.setLoginUrl(<span class="string">&quot;/toLogin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>创建一个自定义Realm类来实现授权和认证</strong></p>
<p>创建UserRealm类，并继承AuthorizingRealm类</p>
<p>重写其中的授权和认证方法。</p>
<p><strong>授权</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;执行了===&gt;授权doGetAuthorizationInfo&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>认证</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;执行了===&gt;认证doGetAuthenticationInfo&quot;</span>);</span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">userToken</span> <span class="operator">=</span> (UsernamePasswordToken) authenticationToken;</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.queryUserByName(userToken.getUsername());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(user==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">//当用户不存在时，抛出用户名不存在异常</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//加密方式默认是MD5   可以自定义改变加密方式，改为其他如  盐值加密MD5</span></span><br><span class="line">    <span class="comment">//出于安全性考虑，密码认证由shiro来完成</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthenticationInfo</span>(<span class="string">&quot;&quot;</span>,user.getPwd(),<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>总结</strong></p>
<p><strong>shiro真正执行了授权和认证方法的代码在userRealm中</strong></p>
<p>config类配置<strong>网站</strong>对用户的身份验证等</p>
<p>userRealm类用来实现对<strong>用户</strong>进行授权认证等</p>
<h3 id="对用户的授权"><a href="#对用户的授权" class="headerlink" title="对用户的授权"></a>对用户的授权</h3><p>在config中设置未授权的跳转页面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bean.setUnauthorizedUrl(<span class="string">&quot;/noAuthed&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>在UserRealm<strong>认证代码</strong>中，将principal传给授权代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthenticationInfo</span>(user,user.getPwd(),<span class="string">&quot;&quot;</span>);<span class="comment">//第一个参数</span></span><br></pre></td></tr></table></figure>



<p>在UserRealm<strong>授权代码</strong>中，根据数据库中的用户权限，对用户授权</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取当前对象的信息</span></span><br><span class="line"><span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) subject.getPrincipal();  <span class="comment">//接受由认证代码传来的principal</span></span><br><span class="line">info.addStringPermission(user.getPerms());  <span class="comment">//将数据库中写好的用户权限授予用户</span></span><br></pre></td></tr></table></figure>



<p>最后在config中设置相应的权限过滤即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据权限拦截</span></span><br><span class="line">filterMap.put(<span class="string">&quot;/user/add&quot;</span>,<span class="string">&quot;perms[user:add]&quot;</span>);</span><br><span class="line">filterMap.put(<span class="string">&quot;/user/update&quot;</span>,<span class="string">&quot;perms[user:update]&quot;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="整合Thymeleaf"><a href="#整合Thymeleaf" class="headerlink" title="整合Thymeleaf"></a>整合Thymeleaf</h3><ol>
<li><p>导入包thymeleaf-extras-shiro</p>
</li>
<li><p>在html文件中新增命名空间：</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:shiro=&quot;http://www.thymeleaf.org/thymeleaf-extras-shiro&quot;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在shiro配置类中开启方言</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启shiro方言，让shiro能在html中使用</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ShiroDialect <span class="title function_">getShiroDialect</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroDialect</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就可以在html中使用shiro的函数。</p>
<h3 id="shiro的RememberMe"><a href="#shiro的RememberMe" class="headerlink" title="shiro的RememberMe"></a>shiro的RememberMe</h3><ol>
<li>配置rememberMeCookie</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> SimpleCookie <span class="title function_">rememberMeCookie</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">SimpleCookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleCookie</span>(<span class="string">&quot;rememberMe&quot;</span>);</span><br><span class="line">    cookie.setMaxAge(<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>);</span><br><span class="line">    <span class="keyword">return</span> cookie;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>配置cookieRememberMeManager</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> CookieRememberMeManager <span class="title function_">cookieRememberMeManager</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">CookieRememberMeManager</span> <span class="variable">manager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CookieRememberMeManager</span>();</span><br><span class="line">    manager.setCookie(rememberMeCookie());<span class="comment">//将上面配的方法拿过来，传参cookie</span></span><br><span class="line">    <span class="comment">//设置cookie加密的密钥 建议每个项目都不一样 默认AES算法 密钥长度(128 256 512 位)</span></span><br><span class="line">    <span class="comment">//manager.setCipherKey(Base64.decode(&quot;4AvVhmFLUs0KTA3Kprsdag==&quot;));</span></span><br><span class="line">    <span class="keyword">return</span> manager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="3">
<li>在SecurityManager中RememberMeManager</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">securityManager.setRememberMeManager(cookieRememberMeManager());</span><br></pre></td></tr></table></figure>



<ol start="4">
<li>在页面中创建记住我按钮（form表单下）</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;rememberMe&quot;</span>&gt;</span>记住我</span><br></pre></td></tr></table></figure>

<p><a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/xhf852963/article/details/117111978">其他详细参考文档<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="注销"><a href="#注销" class="headerlink" title="注销"></a>注销</h3><p><a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34021712/article/details/84722252">系统的学习注销<i class="fas fa-external-link-alt"></i></a></p>
<p>可以直接通过shiro的拦截器拦截”&#x2F;logout”请求，让其logout</p>
<p><code>shiro</code>的默认登出也会清理用户的<code>session</code>信息,并且也会清理掉 <code>redis</code>中缓存的用户 <code>身份认证</code>和 <code>权限认证</code>的相关信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过过滤器实现登出</span></span><br><span class="line">filterMap.put(<span class="string">&quot;/logout&quot;</span>,<span class="string">&quot;logout&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>也可以自己配置一个Controller来实现登出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/logout&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">logout</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line">    subject.logout();</span><br><span class="line">    model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;已退出，请重新登录&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h2><p>学习目标：</p>
<ul>
<li>了解Swagger的作用和概念</li>
<li>了解前后端分离</li>
<li>在SpringBoot中继承Swagger</li>
</ul>
<h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p><strong>前后端分离：</strong></p>
<p>Vue + SpringBoot</p>
<p>后端时代：前端只用管理静态页面：Html&#x3D;&#x3D;》后端。模板引擎JSP</p>
<p>前后端分离时代：</p>
<ul>
<li><p>后端：Controller、Services、Dao</p>
</li>
<li><p>前端：前端控制层、视图层</p>
</li>
<li><p>前后端如何交互？&#x3D;&#x3D;》API</p>
</li>
<li><p>前后端相对独立，低耦合</p>
</li>
<li><p>前后端甚至可以部署在不同的服务器上</p>
</li>
</ul>
<p>问题：</p>
<ul>
<li>前后端集成联调，前后端人员无法及时协商</li>
</ul>
<p>解决方案：</p>
<ul>
<li><p>首先制定schema，实时更新最新的API，降低集成风险</p>
</li>
<li><p>前后端分离：</p>
<ul>
<li>前端测试后端接口：postman</li>
<li>后端提供接口，需要及时更新最新的消息及改动</li>
</ul>
</li>
<li><p>Swagger号称世界上最流行的API框架</p>
</li>
<li><p>RestFul API文档在线自动生成工具&#x3D;&#x3D;&#x3D;》API文档与api定义同时更新</p>
</li>
<li><p>直接运行，可以在线测试API接口（Controller、Pequestmapping）</p>
</li>
<li><p>支持多种语言</p>
</li>
</ul>
<h3 id="集成到SpringBoot"><a href="#集成到SpringBoot" class="headerlink" title="集成到SpringBoot"></a>集成到SpringBoot</h3><p>核心是<strong>Docket</strong></p>
<ol>
<li><p>导包</p>
<p>3.0版本的swagger可以使用starter</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>在application.properties中配置</strong></li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mvc.pathmatch.matching-strategy</span>=<span class="string">ant_path_matcher</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>编写swagger的配置文件</li>
</ol>
<p>（4. 不用在主启动类中加@EnableOpenAPI 也可以）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span>     <span class="comment">//开启swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="配置swagger"><a href="#配置swagger" class="headerlink" title="配置swagger"></a>配置swagger</h3><p>通过Docket返回swagger信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过swagger的Docket来配置swagger信息</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.OAS_30).apiInfo(apiInfo());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>通过ApiInfoBuilder来配置ApiInfo，交给Docket</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ApiInfo <span class="title function_">apiInfo</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApiInfoBuilder</span> <span class="variable">infoBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>();</span><br><span class="line">    infoBuilder.title(<span class="string">&quot;TestInfoBuilder&quot;</span>);</span><br><span class="line">    infoBuilder.description(<span class="string">&quot;TestDescription&quot;</span>);</span><br><span class="line">    infoBuilder.contact(<span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;lanyo&quot;</span>, 				<span class="string">&quot;https://www.baidu.com&quot;</span>,<span class="string">&quot;1140144729@qq.com&quot;</span>));</span><br><span class="line">    <span class="keyword">return</span> infoBuilder.build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="配置扫描接口"><a href="#配置扫描接口" class="headerlink" title="配置扫描接口"></a>配置扫描接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.OAS_30)</span><br><span class="line">            .apiInfo(apiInfo())</span><br><span class="line">            .select()</span><br><span class="line">            <span class="comment">//RequestHandlerSelectors，配置要扫描的接口的方式</span></span><br><span class="line">            <span class="comment">//basePackage：指定要扫描的包</span></span><br><span class="line">            <span class="comment">//withClassAnnotation：扫描类上的注解，参数是一个注解的反射对象</span></span><br><span class="line">            <span class="comment">//withMethodAnnotation：扫描方法上的注解</span></span><br><span class="line">            .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.example.swagger.controller&quot;</span>))<span class="comment">//通过包扫描查询API</span></span><br><span class="line">            <span class="comment">//.paths(PathSelectors.ant(&quot;/Doesnt want&quot;))//根据路径查询匹配的API</span></span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>配置是否启动Swagger</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docket.enable(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>



<p><strong>根据生产环境判断是否需要开启swagger</strong></p>
<p><u><em>product环境中一般不用swagger</em></u></p>
<p>Profiles.of设置想要的环境</p>
<p>environment.acceptsProfiles(profiles)  在环境中匹配有无想要的环境，有责返回true，否则返回false</p>
<p>然后即可通过enable_swagger判断是否需要开启swagger。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">(Environment environment)</span>&#123;</span><br><span class="line">        <span class="type">Profiles</span> <span class="variable">profiles</span> <span class="operator">=</span> Profiles.of(<span class="string">&quot;dev&quot;</span>,<span class="string">&quot;pro&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">enable_swagger</span> <span class="operator">=</span> environment.acceptsProfiles(profiles);</span><br></pre></td></tr></table></figure>



<p><strong>配置API文档分组</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.OAS_30)</span><br><span class="line">.groupName(<span class="string">&quot;lanyo&quot;</span>)<span class="comment">//给当前Docket设置组名，多分组可以通过实现多个Docket实例，来设置不同组名</span></span><br></pre></td></tr></table></figure>



<p><strong>返回实体类的controller被扫描到后，实体类也能被识别到，就算实体类没有@Api相关注释来声明</strong></p>
<p>@Api(tag &#x3D; “”)可以作用于<strong>模块（controller、实体类）</strong>上</p>
<p>@ApiOperation(“XXX”)作用于<strong>方法</strong>上 </p>
<p>@ApiParam 可以作用在<strong>参数</strong>上</p>
<p>@ApiModel 可以作用在<strong>实体类</strong>上</p>
<p><strong>总结</strong>：</p>
<ol>
<li><p>可以通过swagger给一些比较<strong>难理解的属性或者接口</strong>，增加注释信息</p>
</li>
<li><p>接口文档实时更新</p>
</li>
<li><p>可以在线测试接口</p>
</li>
<li><p>是一个不错的工具</p>
</li>
</ol>
<h2 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h2><h3 id="异步任务"><a href="#异步任务" class="headerlink" title="异步任务"></a>异步任务</h3><p>新建一个多线程服务包（service.package)</p>
<p>创建一个异步方法的异步类，加上@<strong>Service</strong>的注解(Async.class)</p>
<p><strong>在里面编写异步方法，方法上要加上@Async注解</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Async</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在主启动类上加上开启异步注解的功能——**@EnableAsync**</p>
<p>在controller中调用异步方法，已经可以实现异步的效果。</p>
<p>总结：</p>
<ol>
<li><strong>编写异步方法（@Async）</strong></li>
<li><strong>开启异步支持注解（@EnableAsync）</strong></li>
<li><strong>调用异步方法</strong></li>
</ol>
<h3 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h3><p>需要用到两个注解：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@EnableScheduling   写在主启动类上，表示启用定时任务功能</span><br><span class="line">@Scheduled(cron = &quot;0 0 0 24 4 ?&quot;)写在方法上，表示这个方法会在指定时间执行</span><br></pre></td></tr></table></figure>

<p>@Scheduiled注解的参数是一个cron表达式，六个参数分别代表：秒、分、时、日、月、周几</p>
<p>网上有现成的cron表达式生成器</p>
<p><strong><u><em>Scheduled方法应该写在Services里面。</em></u></strong></p>
<p>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scheduled(cron = &quot;0 16 16 * * ?&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">TestScheduled</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;定时方法执行了&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="邮件发送"><a href="#邮件发送" class="headerlink" title="邮件发送"></a>邮件发送</h3><p>导包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#配置使用Spring.mail</span></span><br><span class="line"><span class="attr">spring.mail.username</span>=<span class="string">1140144729@qq.com</span></span><br><span class="line"><span class="attr">spring.mail.password</span>=<span class="string">dxnwhlkoslujidai</span></span><br><span class="line"><span class="attr">spring.mail.host</span>=<span class="string">smtp.qq.com</span></span><br><span class="line"><span class="comment">#开起加密验证</span></span><br><span class="line"><span class="attr">spring.mail.properties.mail.smtl.sll.enable</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>



<p><strong>简单邮件示例</strong>：</p>
<p>发送邮件都需要用到<strong>MailSender</strong>&#x3D;&#x3D;&#x3D;》<strong>JavaMailSenderImpl</strong>类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">JavaMailSenderImpl javaMailSender;<span class="comment">//要先配置了上面的properties，否则这里会报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//发送一个***简单***的邮件</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">SendMail</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">SimpleMailMessage</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleMailMessage</span>();</span><br><span class="line">    message.setSubject(<span class="string">&quot;邮件标题测试&quot;</span>);<span class="comment">//标题</span></span><br><span class="line">    message.setText(<span class="string">&quot;邮件正文测试&quot;</span>);<span class="comment">//正文</span></span><br><span class="line">    message.setTo(<span class="string">&quot;1140144729@qq.com&quot;</span>);<span class="comment">//去向</span></span><br><span class="line">    message.setFrom(<span class="string">&quot;1140144729@qq.com&quot;</span>);<span class="comment">//来源</span></span><br><span class="line">    javaMailSender.send(message);<span class="comment">//通过sneder发送</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>复杂邮件实例</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送一个复杂的邮件</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">SendComplexMail</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException &#123;</span><br><span class="line">    <span class="type">MimeMessage</span> <span class="variable">message</span> <span class="operator">=</span> javaMailSender.createMimeMessage();</span><br><span class="line">    <span class="comment">//通过helper封装message,需要开启multiple来发送多样式文本、行内元素或者附件</span></span><br><span class="line">    <span class="type">MimeMessageHelper</span> <span class="variable">helper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(message,<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//设置邮件正文</span></span><br><span class="line">    helper.setSubject(<span class="string">&quot;复杂邮件测试&quot;</span>);</span><br><span class="line">    helper.setText(<span class="string">&quot;&lt;p style=&#x27;color:red&#x27;&gt;复杂邮件测试&lt;/p&gt;&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//没有true无法将html语句渲染出来</span></span><br><span class="line">    <span class="comment">//helper.setText(&quot;&lt;p style=&#x27;color:red&#x27;&gt;复杂邮件测试&lt;/p&gt;&quot;);</span></span><br><span class="line">    <span class="comment">//添加邮件的附件</span></span><br><span class="line">    helper.addAttachment(<span class="string">&quot;附件测试&quot;</span>,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C://Users/ASUS/Desktop/面经.md&quot;</span>));</span><br><span class="line">    <span class="comment">//设置发送和接受</span></span><br><span class="line">    helper.setTo(<span class="string">&quot;1140144729@qq.com&quot;</span>);</span><br><span class="line">    helper.setFrom(<span class="string">&quot;1140144729@qq.com&quot;</span>);</span><br><span class="line">    <span class="comment">//交由sender发送邮件</span></span><br><span class="line">    javaMailSender.send(message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Dubbo和Zookeeper集成"><a href="#Dubbo和Zookeeper集成" class="headerlink" title="Dubbo和Zookeeper集成"></a>Dubbo和Zookeeper集成</h2><h3 id="什么是分布式系统"><a href="#什么是分布式系统" class="headerlink" title="什么是分布式系统"></a>什么是分布式系统</h3><p>在《分布式系统原理与范型》一书中有如下定义：“分布式系统是<strong>若干独立计算机的集合</strong>，这些计算机对于用户来说就像单个相关系统”；</p>
<p>分布式系统是由一组<strong>通过网络进行通信</strong>、为了完成共同的任务而协调工作的计算机节点组成的系统。分布式系统的出现是为了用廉价的、普通的机器完成单个计算机无法完成的计算、存储任务。其目的是<strong>利用更多的机器，处理更多的数据</strong>。</p>
<p>分布式系统（distributed system）是建立在网络之上的软件系统。</p>
<p>首先需要明确的是，<u><em>只有当单个节点的处理能力无法满足日益增长的计算、存储任务的时候，且硬件的提升（加内存、加磁盘、使用更好的CPU）高昂到得不偿失的时候，应用程序也不能进一步优化的时候，我们才需要考虑分布式系统。</em></u>因为，分布式系统要解决的问题本身就是和单机系统一样的，而由于分布式系统多节点、通过网络通信的拓扑结构，会引入很多单机系统没有的问题，为了解决这些问题又会引入更多的机制、协议，带来更多的问题。。。</p>
<p>随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，<strong>分布式服务架构以及流动计算架构势在必行</strong>，急需<strong>一个治理系统</strong>确保架构有条不紊的演进。</p>
<p>当访问量逐渐增大，单一应用增加机器带来的加速度越来越小，<strong>将应用拆成互不相干的几个应用，以提升效率。</strong>此时，用于加速前端页面开发的Web框架(MVC)是关键。</p>
<p>通过切分业务来实现各个模块独立部署，降低了维护和部署的难度，团队各司其职更易管理，性能扩展也更方便，更有针对性。</p>
<p>缺点：公用模块无法重复利用，开发性的浪费</p>
<p><strong>分布式服务架构</strong></p>
<p>当垂直应用越来越多，应用之间交互不可避免，<strong>将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心</strong>，使前端应用能更快速的响应多变的市场需求。此时，用于提高业务复用及整合的**分布式服务框架(RPC)**是关键。</p>
<h3 id="什么是RPC"><a href="#什么是RPC" class="headerlink" title="什么是RPC"></a>什么是RPC</h3><p>RPC【Remote Procedure Call】是指<strong>远程过程调用</strong>，是一种<strong>进程间通信方式</strong>，他是一种<strong>技术的思想</strong>，而不是规范。它允许程序调用另一个地址空间（通常是共享网络的另一台机器上）的过程或函数，而不用程序员显式编码这个远程调用的细节。即<u>程序员无论是调用本地的还是远程的函数，本质上编写的调用代码基本相同</u>。</p>
<p>也就是说两台服务器A，B，一个应用部署在A服务器上，想要调用B服务器上应用提供的函数&#x2F;方法，由于不在一个内存空间，不能直接调用，需要通过网络来表达调用的语义和传达调用的数据。为什么要用RPC呢？就是无法在一个进程内，甚至一个计算机内通过本地调用的方式完成的需求【<strong>无法通过本地调用实现</strong>】，比如不同的系统间的通讯，甚至不同的组织间的通讯，由于计算能力需要横向扩展，需要在多台机器组成的集群上部署应用。<strong>RPC就是要像调用本地的函数一样去调远程函数</strong>；</p>
<h3 id="什么是Dubbo"><a href="#什么是Dubbo" class="headerlink" title="什么是Dubbo"></a>什么是Dubbo</h3><p>Apache Dubbo是一块高性能、轻量级的开源Java RPC框架，提供了<strong>六大</strong>核心能力：</p>
<ul>
<li>面向接口代理的高性能RPC调用</li>
<li>智能容错和负载均衡</li>
<li>服务自动注册和发现</li>
<li>高度可扩展能力</li>
<li>运行期流量调度</li>
<li>可视化的服务治理与运维。</li>
</ul>
<p>设计模式：生产者消费者模型、 </p>
<h2 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h2><p>学完了springboot并真正的掌握、熟练，只能算作中级开发，接下来要学习更高一级的架构——微服务架构</p>
<p>微服务架构的提出基于，当前单服务器系统已经无法满足日益增多的需求，负载过高。如果只是一昧地增加处理服务器，是远远不够的，对于性能的提升相当有限，也会有更多的隐患。</p>
<p>于是微服务架构应运而生，将所有的功能都模块化，而不是全都集中在一个项目之中。并且将不同的服务部署在不同的服务器上，通过HTTP、RPC来进行异步调用。</p>
<p>但是微服务架构的使用也存在着一些需要解决的问题：</p>
<ol>
<li>这么多服务，客户端如何访问？</li>
<li>服务之间如何通信？</li>
<li>服务太多了，该如何治理？</li>
<li>服务挂了，怎么办？</li>
</ol>
<p>针对以上问题，有一套方案：</p>
<ol>
<li>网关</li>
<li>Dubbo，是一个基于JAVA的轻量级、高性能RPC通信框架。</li>
<li>Zookeeper，可以方便快捷地管理众多服务。</li>
<li>熔断机制，采用之前SPringCloudNetflix的Hystrix（已经不再维护了）</li>
</ol>
<p>本质上，针对的是：</p>
<ol>
<li>API网关、服务的路由</li>
<li>Http、RPC框架、异步调用</li>
<li>服务注册与发现，可用性</li>
<li>熔断机制，服务降级</li>
</ol>
<p>再究其本质，就是因为网络是不可靠的，无法得到其会在何时何地出现怎样的问题，为了避免、解决问题，就需要上述这些东西。</p>

        </div>

        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/spring/">#spring</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/springboot%E5%AD%A6%E4%B9%A0%EF%BC%88runoob%EF%BC%89/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">SpringBoot学习（Runoob）</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/%E5%85%AB%E8%82%A1%E6%96%87-java%E5%9F%BA%E7%A1%80/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">八股文-java基础</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">lanyoooo</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E5%8F%91%E5%B1%95%E5%8F%98%E8%BF%81%EF%BC%9A"><span class="nav-text">开发发展变迁：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpringBoot%E5%AD%A6%E4%B9%A0%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="nav-text">SpringBoot学习内容：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%87%E6%80%BB%EF%BC%9A"><span class="nav-text">汇总：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFSpringBoot%EF%BC%9F"><span class="nav-text">什么是SpringBoot？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AASpringBoot%E7%A8%8B%E5%BA%8F"><span class="nav-text">第一个SpringBoot程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%88%9D%E6%8E%A2"><span class="nav-text">原理初探</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%EF%BC%88%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D-%EF%BC%89"><span class="nav-text">自动配置（自动装配*）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-text">结论</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringApplication-run%E6%96%B9%E6%B3%95"><span class="nav-text">SpringApplication.run方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#yaml%E6%A6%82%E8%BF%B0%EF%BC%9A"><span class="nav-text">yaml概述：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="nav-text">基础语法：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%BA%E5%A4%A7%E4%B9%8B%E5%A4%84%EF%BC%9A"><span class="nav-text">强大之处：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#yaml%E9%85%8D%E7%BD%AE%E4%B8%8Eproperties%E9%85%8D%E7%BD%AE%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-text">yaml配置与properties配置的比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%BE%E6%95%A3%E7%BB%91%E5%AE%9A%EF%BC%9A"><span class="nav-text">松散绑定：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSP303%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C%EF%BC%9A"><span class="nav-text">JSP303数据校验：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-text">配置文件的优先级</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="nav-text">多环境配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Springboot-WEB%E5%BC%80%E5%8F%91"><span class="nav-text">Springboot WEB开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="nav-text">静态资源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E5%88%B6%E9%A6%96%E9%A1%B5"><span class="nav-text">定制首页</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="nav-text">模板引擎</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8bootstrap%E6%A8%A1%E6%9D%BF"><span class="nav-text">使用bootstrap模板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E6%A0%B7%E5%BC%8F%E4%B8%A2%E5%A4%B1%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">关于样式丢失的问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A3%85%E9%85%8D%E6%89%A9%E5%B1%95springmvc"><span class="nav-text">装配扩展springmvc</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E5%9B%BD%E9%99%85%E5%8C%96"><span class="nav-text">页面国际化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BB%E5%BD%95-%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-text">登录+拦截器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%95%E7%A4%BA%E5%91%98%E5%B7%A5%E9%A1%B5%E9%9D%A2%EF%BC%9A"><span class="nav-text">展示员工页面：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%86%99%E4%B8%80%E4%B8%AA%E5%AE%8C%E6%95%B4%E7%9A%84%E9%A1%B9%E7%9B%AE"><span class="nav-text">如何写一个完整的项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9E%E9%A1%BE%E7%8E%AF%E8%8A%82"><span class="nav-text">回顾环节</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%BB%AD"><span class="nav-text">后续</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E5%90%88%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="nav-text">整合数据源</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JDBC"><span class="nav-text">JDBC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Druid"><span class="nav-text">Druid</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">遇到的问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E5%90%88mybatis"><span class="nav-text">整合mybatis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpringSecurity"><span class="nav-text">SpringSecurity</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%8C%85"><span class="nav-text">导包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-text">使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83"><span class="nav-text">用户授权</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E9%AA%8C%E8%AF%81"><span class="nav-text">权限验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%90%AF%E6%B3%A8%E9%94%80"><span class="nav-text">开启注销</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="nav-text">登录页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%B0%E4%BD%8F%E6%88%91"><span class="nav-text">记住我</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF"><span class="nav-text">CSRF</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shiro"><span class="nav-text">Shiro</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%90%88%E5%88%B0SpringBoot"><span class="nav-text">整合到SpringBoot</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%8C%85%EF%BC%9A"><span class="nav-text">导包：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEshiro"><span class="nav-text">配置shiro</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%94%A8%E6%88%B7%E7%9A%84%E6%8E%88%E6%9D%83"><span class="nav-text">对用户的授权</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%90%88Thymeleaf"><span class="nav-text">整合Thymeleaf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shiro%E7%9A%84RememberMe"><span class="nav-text">shiro的RememberMe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E9%94%80"><span class="nav-text">注销</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Swagger"><span class="nav-text">Swagger</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9B%86%E6%88%90%E5%88%B0SpringBoot"><span class="nav-text">集成到SpringBoot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEswagger"><span class="nav-text">配置swagger</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%89%AB%E6%8F%8F%E6%8E%A5%E5%8F%A3"><span class="nav-text">配置扫描接口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1"><span class="nav-text">任务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="nav-text">异步任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="nav-text">定时任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81"><span class="nav-text">邮件发送</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo%E5%92%8CZookeeper%E9%9B%86%E6%88%90"><span class="nav-text">Dubbo和Zookeeper集成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F"><span class="nav-text">什么是分布式系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFRPC"><span class="nav-text">什么是RPC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFDubbo"><span class="nav-text">什么是Dubbo</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AA%E6%9D%A5"><span class="nav-text">未来</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
